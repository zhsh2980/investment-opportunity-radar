# 01 - 项目概述

## 1.1 项目简介

**投资机会雷达**是一个自动化的投资机会发现系统，它能够：

1. 📥 **自动抓取** - 从 WeRSS 获取订阅的公众号文章
2. 🤖 **智能分析** - 使用 DeepSeek AI 分析文章中的投资机会
3. 📱 **实时推送** - 通过钉钉机器人推送高分机会
4. 📊 **可视化展示** - Web 界面查看分析结果和历史记录

### 核心价值

- **省时间**：不用每天手动刷公众号
- **不遗漏**：AI 帮你筛选重要信息
- **可回溯**：所有分析结果都有记录

---

## 1.2 技术栈

### 后端
| 技术 | 版本 | 用途 |
|------|------|------|
| Python | 3.11 | 主语言 |
| FastAPI | 0.109+ | Web 框架 |
| SQLAlchemy | 2.0 | ORM |
| Celery | 5.3+ | 异步任务 |
| Celery Beat | - | 定时调度 |

### 数据存储
| 技术 | 用途 |
|------|------|
| PostgreSQL | 主数据库 |
| Redis | 消息队列 + 缓存 |

### 前端
| 技术 | 用途 |
|------|------|
| Jinja2 | 模板引擎 |
| 原生 CSS | 样式 |
| 原生 JS | 交互 |

### 外部服务
| 服务 | 用途 |
|------|------|
| WeRSS | 公众号文章来源 |
| DeepSeek | AI 分析（reasoner 模型）|
| 钉钉 Webhook | 消息推送 |

### 部署
| 技术 | 用途 |
|------|------|
| Docker Compose | 容器编排 |
| Nginx | 反向代理 |

---

## 1.3 核心流程

```
┌─────────────────────────────────────────────────────────────────┐
│                         系统工作流程                              │
└─────────────────────────────────────────────────────────────────┘

  ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
  │  WeRSS   │────▶│ 文章抓取  │────▶│ DeepSeek │────▶│  存储DB  │
  │ (数据源)  │     │  Celery  │     │  AI分析  │     │ Postgres │
  └──────────┘     └──────────┘     └──────────┘     └──────────┘
                                                           │
                         ┌─────────────────────────────────┤
                         │                                 │
                         ▼                                 ▼
                   ┌──────────┐                     ┌──────────┐
                   │   钉钉   │                     │  Web UI  │
                   │   推送   │                     │  展示    │
                   └──────────┘                     └──────────┘
```

### 定时调度

| 时间 | 任务 | 说明 |
|------|------|------|
| 07:00 | slot_task | 早间分析 |
| 12:00 | slot_task | 午间分析 |
| 14:00 | slot_task | 下午分析 |
| 18:00 | slot_task | 晚间分析 |
| 22:00 | slot_task + daily_report | 夜间分析 + 日报生成 |

### 推送策略

- **前 4 次**（07/12/14/18）：只在发现高分机会时推送
- **22:00**：必推日报，无论有无机会

---

## 1.4 系统架构图

```
                            ┌─────────────────┐
                            │    用户浏览器    │
                            └────────┬────────┘
                                     │
                            ┌────────▼────────┐
                            │     Nginx       │
                            │   (反向代理)     │
                            └────────┬────────┘
                                     │
        ┌────────────────────────────┼────────────────────────────┐
        │                            │                            │
        │         ┌──────────────────▼──────────────────┐         │
        │         │           radar-web                 │         │
        │         │         FastAPI 应用                │         │
        │         │    (页面渲染 + API 服务)            │         │
        │         └──────────────────┬──────────────────┘         │
        │                            │                            │
        │         ┌──────────────────┴──────────────────┐         │
        │         │                                     │         │
        │  ┌──────▼──────┐                    ┌─────────▼───────┐ │
        │  │ radar-worker│                    │  radar-beat     │ │
        │  │ Celery 工人 │◀───────────────────│ 定时调度器       │ │
        │  └──────┬──────┘                    └─────────────────┘ │
        │         │                                               │
        │         │              Docker Network                   │
        └─────────┼───────────────────────────────────────────────┘
                  │
        ┌─────────┴─────────┐
        │                   │
┌───────▼───────┐   ┌───────▼───────┐
│ radar-postgres│   │  radar-redis  │
│  PostgreSQL   │   │    Redis      │
└───────────────┘   └───────────────┘
```
